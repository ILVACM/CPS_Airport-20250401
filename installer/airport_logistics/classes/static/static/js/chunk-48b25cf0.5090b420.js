(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48b25cf0"],{"1beb":function(e,t,i){"use strict";i("57b0")},"4fa2":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",{staticClass:"container"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("实时预览")])]),i("div",[i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.viewMethodChange},model:{value:e.viewMethod,callback:function(t){e.viewMethod=t},expression:"viewMethod"}},e._l(e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-row",[i("el-col",{style:e.image_style,attrs:{span:24,type:"flex",align:"middle"}},[i("canvas",{attrs:{id:"canvas",height:e.screenHeight,width:"100%"}})])],1)],1)],1)],1)},a=[],r=(i("d3b7"),i("25f0"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("fec4"),i("5c96")),s={name:"RealTimeVideo",data:function(){return{imageSrc:"",socket:null,isPause:!0,label_dicts:[],image_src:"data:image/jpeg;base64,",screenWidth:5/7*window.innerWidth,screenHeight:5/7*window.innerHeight,imageWidth:this.screenWidth/4,imageHeight:this.screenHeight/5,image_style:"height:"+this.screenWidth+"px;",options:[{label:"上视角",value:0},{label:"下视角",value:1},{label:"双视角",value:2}],viewMethod:2,detected_Status:!1}},created:function(){},mounted:function(){this.image_src="data:image/jpeg;base64,",this.screenWidth=5/7*window.innerWidth,this.screenHeight=5/7*window.innerHeight,this.imageWidth=this.screenWidth/6,this.imageHeight=this.screenHeight/5,this.image_style="height:"+this.screenHeight+"px",this.getConfig(),this.timer=null},beforeDestroy:function(){},destroyed:function(){clearInterval(this.timer)},methods:{getConfig:function(){var e=this;this.$store.dispatch("systemconfig/getConfig").then((function(t){200===t.status?(e.detected_Status=0===t.data.status,e.input_view=t.data.input_view,e.detected_Status?e.setInterval():null!=e.timer&&(clearInterval(e.timer),e.timer=null)):Object(r["Message"])({message:t.message,type:"error",duration:3e3})})).catch((function(e){console.error("获取配置信息失败:",e)}))},setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this,t=1e3,i=this.screenHeight,n="/realTimeVideo/videoStream",a=50,r=document.getElementById("canvas"),s=document.createElement("canvas"),h=s.getContext("2d"),c=r.getContext("2d"),o=new Image,l=null;this.timer=setInterval((function(){l&&l.abort(),l=new AbortController,fetch(n,{signal:l.signal}).then((function(e){return e.blob()})).then((function(n){URL.revokeObjectURL(o.src);var a=e.viewMethod;o.src=URL.createObjectURL(n),o.onload=function(){var e=Math.min(t/o.width,i/o.height);if(2===a){var n=o.width*e,l=o.height*e;return o.width=n,o.height=l,r.width=n,r.height=l,void c.drawImage(o,0,0,o.width,o.height)}s.width=o.width,s.height=o.height;var d=0,g=1;0===a?(d=0,g=2):1===a&&(d=o.height/2,g=2),h.drawImage(o,0,0),e=Math.min(t/o.width,i/o.height*g);var u=o.width*e,m=o.height*e,w=h.getImageData(0,d,o.width,o.height/g);r.width=u,r.height=m,c.putImageData(w,0,0)}})).catch((function(e){console.error("Error fetching camera stream:",e)}))}),a)})),viewMethodChange:function(){}}},h=s,c=(i("1beb"),i("2877")),o=Object(c["a"])(h,n,a,!1,null,"55569d27",null);t["default"]=o.exports},"57b0":function(e,t,i){}}]);